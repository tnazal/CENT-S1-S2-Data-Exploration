---
author: "CENT S1 Raw Clusters. Raw Impressions / Normalized.Best Matches on S2. Detail "
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    orientation: rows
    source_code: embed
---

```{r}
##########################################################
#
# Inputs: CENT_showlevel.csv, s1_shows_best_clusters.csv,
#         CENT_dct.csv, CENT_dct_cont_growth.csv
#
# Purpose: Detailed trends of C3 impressions and Growth,
#          Season two graphs include only cases that either
#         [1] are intersections of the best other cluster
#         matches, or [2] are intersections of the best other
#         Season 2 alone clusters
#
##########################################################
```


```{r}
library(plyr)
library(dplyr)
library(ggplot2)
library(plotly)
library(scales)
```

```{r}
df <- read.csv("CENT_showlevel.csv") %>% select(-X) %>% 
  filter(Episode_num < 15 & Season_num > 0 & Season_num < 3)
df_dct <- read.csv("CENT_dct_cont.csv")
df_dct_growth <- read.csv("CENT_dct_cont_growth.csv")
lookup <- read.csv("s1_shows_best_clusters.csv")

df$clusters_C3_raw <- lookup$C3_raw_5kmeans[match(df$Show_Name, lookup$Show_Name)]
df$C3_raw_best_match <- lookup$C3_raw_best_matches[match(df$Show_Name, lookup$Show_Name)]
df$C3_raw_best_match_S2 <- lookup$C3_raw_best_matches_S2[match(df$Show_Name, lookup$Show_Name)]

df$clusters_C3_growth <- lookup$C3_growth_5kmeans[match(df$Show_Name, lookup$Show_Name)]
df$C3_growth_best_match <- lookup$C3_growth_best_matches[match(df$Show_Name, lookup$Show_Name)]
df$C3_growth_best_match_S2 <- lookup$C3_growth_best_matches_S2[match(df$Show_Name, lookup$Show_Name)]


df_dct$clusters_C3_raw <- lookup$C3_raw_5kmeans[match(df_dct$Show_Name, lookup$Show_Name)]
df_dct$C3_raw_best_match <- lookup$C3_raw_best_matches[match(df_dct$Show_Name, lookup$Show_Name)]
df_dct$C3_raw_best_match_S2 <- lookup$C3_raw_best_matches_S2[match(df_dct$Show_Name, lookup$Show_Name)]

df_dct$clusters_C3_growth <- lookup$C3_growth_5kmeans[match(df_dct$Show_Name, lookup$Show_Name)]
df_dct$C3_growth_best_match <- lookup$C3_growth_best_matches[match(df_dct$Show_Name, lookup$Show_Name)]
df_dct$C3_growth_best_match_S2 <- lookup$C3_growth_best_matches_S2[match(df_dct$Show_Name, lookup$Show_Name)]


df_dct_growth$clusters_C3_raw <- lookup$C3_raw_5kmeans[match(df_dct_growth$Show_Name, lookup$Show_Name)]
df_dct_growth$C3_raw_best_match <- lookup$C3_raw_best_matches[match(df_dct_growth$Show_Name, lookup$Show_Name)]
df_dct_growth$C3_raw_best_match_S2 <- lookup$C3_raw_best_matches_S2[match(df_dct_growth$Show_Name, lookup$Show_Name)]

df_dct_growth$clusters_C3_growth <- lookup$C3_growth_5kmeans[match(df_dct_growth$Show_Name, lookup$Show_Name)]
df_dct_growth$C3_growth_best_match <- lookup$C3_growth_best_matches[match(df_dct_growth$Show_Name, lookup$Show_Name)]
df_dct_growth$C3_growth_best_match_S2 <- lookup$C3_growth_best_matches_S2[match(df_dct_growth$Show_Name, lookup$Show_Name)]

```



```{r}
my_theme <-  theme(panel.background = element_blank(), 
                   panel.grid.major = element_line(color = "#d8d8d8", linetype = "dotted"), 
                   panel.grid.major.x = element_blank(), 
                   plot.title = element_text(hjust = 0.5),
                   axis.title.y = element_blank(),
                   axis.line.y = element_blank(),
                   axis.ticks.y = element_blank(),
                   axis.line.x = element_line(color = "#d8d8d8", linetype = "dashed"),
                   strip.background = element_blank())
```


C3 Raw S1 Clusters.Best Match.
====================

Row {.tabset}
---------------------------------------

### Raw. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 1, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 2, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 3, Season_num == 1 | Season_num == 2& !is.na(C3_raw_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 4, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
 coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 5, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### Normalized. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 1, period <= 50 | period > 50 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 2, period <= 50 | period > 50 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 3, period <= 50 | period > 50 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))


```

### Normalized. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 4, period <= 50 | period > 50 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))

```


### Normalized. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 5, period <= 50 | period > 50 & !is.na(C3_raw_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))
```



C3 Raw S1 Clusters. S1-S2. Best S2 match
====================

Row {.tabset}
---------------------------------------

### Raw. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 1, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 2, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 3, Season_num == 1 | Season_num == 2& !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 4, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
 coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 5, Season_num == 1 | Season_num == 2 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000), xlim = c(1, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### Normalized. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 1, period <= 50 | period > 50 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 2, period <= 50 | period > 50 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 3, period <= 50 | period > 50 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))


```

### Normalized. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 4, period <= 50 | period > 50 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))

```


### Normalized. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct %>% filter(is.na(clusters_C3_raw) == F, clusters_C3_raw == 5, period <= 50 | period > 50 & !is.na(C3_raw_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2  Raw Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))
```






C3 Growth S1 Clusters.Best Match.
====================

Row {.tabset}
---------------------------------------

### Raw. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 1, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 2, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 3, Season_num == 1 | Season_num == 2& !is.na(C3_growth_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 4, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
 coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 5, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### Normalized. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 1, period <= 50 | period > 50 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 2, period <= 50 | period > 50 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 3, period <= 50 | period > 50 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))


```

### Normalized. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 4, period <= 50 | period > 50 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))

```


### Normalized. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 5, period <= 50 | period > 50 & !is.na(C3_growth_best_match))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))
```



C3 growth S1 Clusters. S1-S2. Best S2 match
====================

Row {.tabset}
---------------------------------------

### Raw. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 1, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 2, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 3, Season_num == 1 | Season_num == 2& !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 4, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
 coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Raw. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 5, Season_num == 1 | Season_num == 2 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 3), xlim = c(2, 13)) +
  facet_wrap(~ Season_num) +
  theme(panel.spacing = unit(0, "lines")) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Impressions, S1-S2 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### Normalized. Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 1, period <= 50 | period > 50 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 2, period <= 50 | period > 50 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### Normalized. Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 3, period <= 50 | period > 50 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))


```

### Normalized. Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 4, period <= 50 | period > 50 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))

```


### Normalized. Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df_dct_growth %>% filter(is.na(clusters_C3_growth) == F, clusters_C3_growth == 5, period <= 50 | period > 50 & !is.na(C3_growth_best_match_S2))) +
  geom_line(aes(x = period, y = dct_values, color = Show_Name)) +
  scale_y_continuous(labels = comma) +
  my_theme 

ggplotly(C3_raw) %>% 
  layout(title = "C3 Normalized Impressions, S1-S2 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100,
                       t = 50))
```