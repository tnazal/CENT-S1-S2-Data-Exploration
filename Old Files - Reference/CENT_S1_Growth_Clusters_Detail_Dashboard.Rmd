---
title: "CENT S1 C3 Impressions on Growth Clusters (Detail)"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    orientation: rows
    source_code: embed
---

```{r}
##########################################################
#
# Inputs: s1_s2_data.csv
#
# Purpose: Detailed view of non-normalized trends for C3
#          and LS impressions and Growth, grouped by S1
#          best clusters. It includes S1 alone, and S1-S2
#          contiguous views. Linear and Smooth trends 
#          overlapped. 
#
##########################################################
```


```{r}
library(plyr)
library(dplyr)
library(ggplot2)
library(plotly)
library(scales)
```

```{r}
df <- read.csv("s1_s2_data.csv") %>% select(-X) %>% filter(Episode_num < 15)
```

```{r}
my_theme <-  theme(panel.background = element_blank(), 
                   panel.grid.major = element_line(color = "#d8d8d8", linetype = "dotted"), 
                   panel.grid.major.x = element_blank(), 
                   plot.title = element_text(hjust = 0.5),
                   axis.title.y = element_blank(),
                   axis.line.y = element_blank(),
                   axis.ticks.y = element_blank(),
                   axis.line.x = element_line(color = "#d8d8d8", linetype = "dashed"),
                   strip.background = element_blank())
```

C3 S1 Impressions
====================

Row {.tabset}
---------------------------------------

### C3 Raw on C3 Growth Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 1, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 2, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 3, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 4, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 5, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### C3 Growth on C3 Growth Cluster 1

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 1, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 2

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 2, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 3

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 3, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 4

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 4, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 5

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 5, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```


LS S1 Impressions
====================

Row {.tabset}
---------------------------------------

### LS Raw on LS Growth Cluster 1

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 1, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 2

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 2, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 3

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 3, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 4

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 4, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 5

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 5, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  my_theme

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### LS Growth on LS Growth Cluster 1

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 1, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 2

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 2, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 3

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 3, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 4

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 4, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 5

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 5, Season_num == 1)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  my_theme

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

C3 S1-S2 Impressions
====================

Row {.tabset}
---------------------------------------

### C3 Raw on C3 Growth Cluster 1

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 1, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 2

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 2, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 3

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 3, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 4

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 4, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Raw on C3 Growth Cluster 5

```{r, fig.align = 'center'}
C3_raw <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 5, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_raw) %>% 
  layout(title = "C3 Raw on C3 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### C3 Growth on C3 Growth Cluster 1

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 1, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 2

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 2, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 3

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 3, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 4

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 4, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### C3 Growth on C3 Growth Cluster 5

```{r, fig.align = 'center'}
C3_growth <- ggplot(df %>% filter(is.na(C3_growth_cluster) == F, C3_growth_cluster == 5, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = C3_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = C3_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(C3_growth) %>% 
  layout(title = "C3 Growth on C3 Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

LS S1-S2 Impressions
====================

Row {.tabset}
---------------------------------------

### LS Raw on LS Growth Cluster 1

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 1, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 2

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 2, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 3

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 3, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 4

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 4, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Raw on LS Growth Cluster 5

```{r, fig.align = 'center'}
LS_raw <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 5, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Impressions, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Impressions, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(ylim = c(0, 1500000)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_raw) %>% 
  layout(title = "LS Raw on LS Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

Row {.tabset}
---------------------------------------

### LS Growth on LS Growth Cluster 1

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 1, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 1",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 2

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 2, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 2",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 3

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 3, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 3",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 4

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 4, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 4",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```

### LS Growth on LS Growth Cluster 5

```{r, fig.align = 'center'}
LS_growth <- ggplot(df %>% filter(is.na(LS_growth_cluster) == F, LS_growth_cluster == 5, Season_num == 1 | Season_num == 2)) +
  geom_line(aes(x = Episode_num, y = LS_Growth, color = Show_Name)) +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Linear"), 
              color = "black", se = F, method = lm, linetype = "dashed") +
  geom_smooth(aes(x = Episode_num, y = LS_Growth, alpha = "Smooth"), 
              color = "#747677", se = F, linetype = "dotted") +
  labs(x = "Episode Number") +
  scale_y_continuous(labels = comma) +
  coord_cartesian(xlim = c(2, 14), ylim = c(0.4, 3)) +
  facet_wrap(~ Season_num) +
  my_theme +
  theme(panel.spacing = unit(-3, "lines"))

ggplotly(LS_growth) %>% 
  layout(title = "LS Growth on LS Growth Cluster 5",
         autosize = FALSE, width = 1700, height = 500, 
         margin = list(l = 150, 
                       r = 50, 
                       b = 100, 
                       t = 50))
```
